[global_tags]
  service = "<%= spec.deployment.sub(/-[0-9a-f]{20}$/, '') %>"
  node_type = "<%= spec.name %>"
  instance = "<%= spec.index %>"
  <% if_p("telegraf.tags") do |tags| tags.each do |tag, value| %>
  <%= tag %> = "<%= value %>"
  <% end; end %>

[agent]
  interval = "1m"
  flush_interval = "1m"
  flush_jitter = "15s"

[[outputs.influxdb]]
  urls = ["<%= p("telegraf.influxdb.url") %>"]
  database = "<%= p("telegraf.influxdb.database") %>"
  retention_policy = "<%= p("telegraf.influxdb.retention_policy") %>"

[[inputs.cpu]]
  percpu = false
  totalcpu = true
[[inputs.disk]]
  ignore_fs = ["tmpfs", "devtmpfs", "none"]
[[inputs.diskio]]
  devices = ["sda", "sdb", "sdc"]
[[inputs.kernel]]
[[inputs.mem]]
[[inputs.processes]]
[[inputs.swap]]
[[inputs.system]]
[[inputs.net]]
[[inputs.netstat]]
[[inputs.nstat]]
  dump_zeros = true
